local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local userInputService = game:GetService("UserInputService")
local runService = game:GetService("RunService")
local bladeBall = workspace:FindFirstChild("BladeBall") -- Replace "BladeBall" with the actual name of the ball
local sphereRadius = 20 -- Radius of the detection sphere

-- Create a visual representation of the sphere
local function createSphere()
    local spherePart = Instance.new("Part")
    spherePart.Name = "DetectionSphere"
    spherePart.Size = Vector3.new(sphereRadius * 2, sphereRadius * 2, sphereRadius * 2)
    spherePart.Shape = Enum.PartType.Ball
    spherePart.Material = Enum.Material.ForceField
    spherePart.Transparency = 0.5
    spherePart.CanCollide = false
    spherePart.Anchored = true
    spherePart.Color = Color3.new(0, 0, 1) -- Blue sphere
    spherePart.Parent = workspace
    return spherePart
end

-- Updates the sphere position to follow the player
local function updateSphere(sphere)
    if character and character:FindFirstChild("HumanoidRootPart") then
        sphere.Position = character.HumanoidRootPart.Position
    end
end

-- Check if the ball is inside the detection sphere
local function isBallInsideSphere(sphere)
    if bladeBall and bladeBall:IsDescendantOf(workspace) then
        local distance = (bladeBall.Position - sphere.Position).Magnitude
        return distance <= sphereRadius
    end
    return false
end

-- Perform the action (hit the ball)
local function hitBladeBall()
    if isBallInsideSphere(detectionSphere) then
        print("Hit the Blade Ball!") -- Replace this with the actual action
        -- Example: Apply a force to the ball
        local ballVelocity = Instance.new("BodyVelocity")
        ballVelocity.Velocity = Vector3.new(0, 50, 0) -- Adjust direction and speed
        ballVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
        ballVelocity.Parent = bladeBall
        game.Debris:AddItem(ballVelocity, 0.2) -- Remove force after 0.2 seconds
    else
        print("Blade Ball is not inside the sphere.")
    end
end

-- Set up the detection sphere
local detectionSphere = createSphere()

-- Update the sphere's position in real-time
runService.RenderStepped:Connect(function()
    updateSphere(detectionSphere)
end)

-- Handle input for both PC and mobile
userInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end -- Ignore input if it's part of the game UI
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        hitBladeBall()
    end
end)

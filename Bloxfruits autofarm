-- Blox Fruits Auto Farm Quest Level Script

-- Setup references
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")
local mouse = player:GetMouse()

-- GUI Setup (For enabling/disabling the Auto Farm)
local playerGui = player:WaitForChild("PlayerGui")
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = playerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 100)
frame.Position = UDim2.new(0.5, -150, 0.5, -50)
frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
frame.BackgroundTransparency = 0.5
frame.Parent = screenGui

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 260, 0, 40)
button.Position = UDim2.new(0, 20, 0, 20)
button.Text = "Toggle Auto Farm"
button.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
button.Parent = frame

-- Auto Farming Logic
local isAutoFarming = false
local questTargetName = "Bandit"  -- Example NPC (change as needed)
local targetHitboxSize = Vector3.new(10, 10, 10)  -- Enlarge hitbox
local flyingHeight = 20  -- Height to fly above NPCs

-- Function to enlarge the hitbox (used to attack NPCs while flying)
local function enlargeHitbox()
    humanoid.HipWidth = 10
    humanoid.HipHeight = 10
    humanoidRootPart.Size = targetHitboxSize
end

-- Function to fly above NPCs
local function flyAboveNPCs()
    humanoidRootPart.CFrame = humanoidRootPart.CFrame * CFrame.new(0, flyingHeight, 0)
end

-- Function to handle Auto Farming
local function autoFarm()
    while isAutoFarming do
        -- Fly above NPCs
        flyAboveNPCs()

        -- Find the closest NPC to attack
        local closestEnemy = nil
        local minDist = math.huge

        for _, enemy in pairs(game.Workspace:GetChildren()) do
            if enemy:IsA("Model") and enemy:FindFirstChild("HumanoidRootPart") then
                if enemy.Name == questTargetName then
                    local dist = (humanoidRootPart.Position - enemy.HumanoidRootPart.Position).Magnitude
                    if dist < minDist then
                        minDist = dist
                        closestEnemy = enemy
                    end
                end
            end
        end

        -- If a valid NPC is found, simulate an attack (can replace with actual attack logic)
        if closestEnemy then
            humanoidRootPart.CFrame = CFrame.new(closestEnemy.HumanoidRootPart.Position)
            print("Attacking " .. closestEnemy.Name)
            -- You can add combat logic here to actually attack, e.g., by using skills or pressing M1
        end

        wait(1)  -- Adjust wait time as needed
    end
end

-- Toggle Auto Farming function
button.MouseButton1Click:Connect(function()
    isAutoFarming = not isAutoFarming
    if isAutoFarming then
        print("Auto Farm Enabled")
        enlargeHitbox()  -- Enlarge the hitbox before starting
        autoFarm()  -- Start auto farming
    else
        print("Auto Farm Disabled")
        humanoid.HipWidth = 2  -- Reset the hitbox to normal
        humanoid.HipHeight = 2
        humanoidRootPart.Size = Vector3.new(2, 2, 2)  -- Reset the hitbox size to default
    end
end)
